{% extends 'base.html' %} {% load crispy_forms_tags %} {% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-8 py-3">
      <h2>Add Todo</h2>
      <form method="post">
        {% csrf_token %}<!---->
        {% if not form.instance.id %}<!---->
        <div class="w-75">
          {{ form|crispy }}
          <button
            formnovalidate
            name="add"
            type="submit"
            class="btn btn-success"
          >
            Submit
          </button>
        </div>

        {% endif %}
        <br />
        <table class="table table-striped table-hover table-bordered">
          <thead>
            <tr class="text-center">
              <th scope="col">Description</th>
              <th scope="col">Added</th>
              <th scope="col">Last update</th>
              <th scope="col">Importance</th>
              <th scope="col">Completed</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody class="text-center">
            {% for todo in todos %}<!---->
            {% if form.instance.id == todo.id %}<!---->
            <tr>
              <td>{{ form.description|as_crispy_field }}</td>
              <td>{{ todo.added_at|timesince }}</td>
              <td>{{ todo.updated_at|timesince }}</td>
              <td>{{ form.importance|as_crispy_field }}</td>
              <td>{{ form.is_completed|as_crispy_field }}</td>
              <td>
                <button
                  name="edit"
                  value="{{ todo.id }}"
                  type="submit"
                  class="btn btn-success"
                >
                  Update
                </button>
              </td>
            </tr>
            {% else %}

            <tr>
              <td>{{ todo.description }}</td>
              <td>{{ todo.added_at|timesince }}</td>
              <td>{{ todo.updated_at|timesince }}</td>

              <td>{{ todo.get_importance_display }}</td>
              <td>
                {% if todo.is_completed == True %}
                <a
                  class="btn btn-success btn-sm"
                  href="{% url 'complete' todo.id %}"
                  >{{ todo.is_completed }}</a
                >
                {% else %}<a
                  class="btn btn-warning btn-sm"
                  href="{% url 'complete' todo.id %}"
                  >{{ todo.is_completed }}</a
                >{% endif %}
              </td>

              <td>
                {% if todo.user == user %}
                <a
                  href="{% url 'delete' todo.id %}"
                  class="btn btn-danger btn-sm my-1"
                  ><i class="bi bi-trash-fill"></i></a
                ><button
                  formnovalidate
                  name="update"
                  value="{{ todo.id }}"
                  class="btn btn-secondary btn-sm mx-1"
                >
                  <i class="bi bi-arrow-repeat"></i>
                </button>
                {% else %}
                <a href="" class="btn btn-primary btn-sm mx-1"
                  ><i class="bi bi-binoculars-fill"></i
                ></a>
                {% endif %}
              </td>
            </tr>
            {% endif %} {% endfor %}
          </tbody>
        </table>
      </form>
    </div>
    <div class="col-4 border bg-white py-3">
      <h2>Filter</h2>
      <form method="get">
        {{ form2|crispy}}

        <input type="submit" value="Submit" class="btn btn-primary" />
        <a href="{% url 'home' %}" class="btn btn-dark">Reset</a>
      </form>
    </div>
  </div>
</div>

{% endblock %}
